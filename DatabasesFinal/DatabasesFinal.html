<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>×¢×‘×•×“×ª ×¡×™×›×•× SQL - ××¡×“×™ × ×ª×•× ×™×</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
            padding: 40px 0;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .question-section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            transform: translateY(0);
            transition: all 0.3s ease;
        }

        .question-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 25px 50px rgba(0,0,0,0.15);
        }

        .question-title {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .question-title h2 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .subsection {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            border-right: 5px solid #667eea;
        }

        .subsection h3 {
            color: #667eea;
            font-size: 1.5rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }

        .subsection h3:before {
            content: "â–¶";
            margin-left: 10px;
            color: #764ba2;
        }

        .research-questions {
            list-style: none;
            padding: 0;
        }

        .research-questions li {
            background: white;
            margin: 15px 0;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-right: 4px solid #667eea;
        }

        .research-questions strong {
            color: #667eea;
            font-size: 1.1rem;
        }

        .erd-container {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .erd-image {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }

        .erd-image:hover {
            transform: scale(1.02);
        }

        .sql-container {
            background: #2d3436;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            position: relative;
            overflow: hidden;
        }

        .sql-container:before {
            content: "SQL";
            position: absolute;
            top: 10px;
            left: 20px;
            color: #00b894;
            font-weight: bold;
            font-size: 0.9rem;
        }

        .sql-code {
            color: #ddd;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.4;
            white-space: pre-wrap;
            margin-top: 20px;
            direction: ltr;
            text-align: left;
        }

        .download-btn {
            display: inline-block;
            background: linear-gradient(135deg, #00b894, #00a085);
            color: white;
            padding: 12px 25px;
            text-decoration: none;
            border-radius: 25px;
            margin: 10px 5px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(0,184,148,0.3);
            cursor: pointer;
        }

        .download-btn:hover {
            background: linear-gradient(135deg, #00a085, #00b894);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,184,148,0.4);
        }

        .normalization-explanation {
            background: linear-gradient(135deg, #e17055, #d63031);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .normalization-explanation h4 {
            margin-bottom: 15px;
            font-size: 1.3rem;
        }

        .normalization-explanation ul {
            margin-right: 20px;
        }

        .normalization-explanation li {
            margin: 10px 0;
            padding-right: 10px;
        }

        .database-info {
            background: linear-gradient(135deg, #a29bfe, #6c5ce7);
            color: white;
            padding: 25px;
            border-radius: 15px;
            margin: 20px 0;
        }

        .research-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .research-table th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
        }

        .research-table td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid #eee;
            vertical-align: top;
        }

        .research-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }

        .research-table tr:hover {
            background-color: #e8f4fd;
        }

        .query-type {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            display: inline-block;
            margin-bottom: 10px;
        }

        .coming-soon {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
        }

        .coming-soon h4 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .question-section {
                padding: 20px;
            }
            
            .sql-code {
                font-size: 0.8rem;
            }

            .research-table {
                font-size: 0.9rem;
            }

            .research-table th,
            .research-table td {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>×¢×‘×•×“×ª ×¡×™×›×•× SQL</h1>
            <p>××¡×“×™ × ×ª×•× ×™× - ×¤×¨×•×™×§×˜ ×’××¨</p>
        </div>

        <!-- Question 1 -->
        <div class="question-section">
            <div class="question-title">
                <h2>×©××œ×” 1 - ×™×¦×™×¨×ª ×“××˜××‘×™×™×¡ ×¢×¦×××™</h2>
                <p>××¢×¨×›×ª ××©×œ×•×—×™× ×©×œ ××•×›×œ ××”×™×¨ (40 × ×§×•×“×•×ª)</p>
            </div>

            <div class="subsection">
                <h3>×©××œ×” 1 - ×“××˜××‘×™×™×¡ ×¢×œ ××¢×¨×›×ª ××©×œ×•×—×™× ×©×œ ××•×›×œ ××”×™×¨</h3>
                
                <h4><strong>×—×œ×§ ×: ×©××œ×•×ª ××—×§×¨</strong></h4>
                <ul class="research-questions">
                    <li>
                        <strong>1. ××™×–×• ××¡×¢×“×” ×§×™×‘×œ×” ××ª ××¡×¤×¨ ×”×”×–×× ×•×ª ×”×’×‘×•×” ×‘×™×•×ª×¨?</strong> ××¢× ×™×™×Ÿ ×›×“×™ ×œ×”×‘×™×Ÿ ××™×œ×• ××¡×¢×“×•×ª ×”×›×™ ×¤×•×¤×•×œ×¨×™×•×ª ×•××•×œ×™ ×œ×—×–×§ ××ª ×©×™×ª×•×£ ×”×¤×¢×•×œ×” ××™×ª×Ÿ.
                    </li>
                    <li>
                        <strong>2. ××™×–×” ×©×œ×™×— ×‘×™×¦×¢ ×”×›×™ ×”×¨×‘×” ××©×œ×•×—×™×?</strong> ×××¤×©×¨ ×œ× ×ª×— ×‘×™×¦×•×¢×™× ×•×œ×ª×’××œ ×©×œ×™×—×™× ××¦×˜×™×™× ×™×.
                    </li>
                    <li>
                        <strong>3. ××” ×××•×¦×¢ ×¡×›×•× ×”×”×–×× ×” ×œ×¤×™ ×œ×§×•×—?</strong> ×¢×•×–×¨ ×œ×–×”×•×ª ×œ×§×•×—×•×ª "×›×‘×“×™×" ×•×œ×”×ª××™× ×œ×”× ×”×˜×‘×•×ª ×©×™×•×•×§×™×•×ª.
                    </li>
                </ul>

                <h4><strong>×—×œ×§ ×‘:</strong></h4>
                <p>×”×“×™××’×¨××” ×”××•×¦×’×ª ××¦×™×’×” 4 ×™×©×•×™×•×ª ×©×•× ×•×ª: <code>Customers</code>, <code>Restaurants</code>, <code>DeliveryPersons</code>, ×•Ö¾<code>Deliveries</code>. ×˜×‘×œ×ª <code>Deliveries</code> ××§×•×©×¨×ª ×œ×›×œ ××—×ª ××”×™×©×•×™×•×ª ×”××—×¨×•×ª ×‘×××¦×¢×•×ª ××¤×ª×—×•×ª ×–×¨×™× (FK), ×›××©×¨ ×›×œ ×©×•×¨×” ×‘×˜×‘×œ×” ××™×™×¦×’×ª ××©×œ×•×— ×‘×•×“×“.</p>
                
                <p>×”×“××˜××‘×™×™×¡ ×¢×•× ×” ×¢×œ ×“×¨×™×©×•×ª <strong>× ×•×¨××œ×™×–×¦×™×”</strong> ×œ×¤×—×•×ª ×¢×“ <strong>×¦×•×¨×” ×©×œ×™×©×™×ª (3NF)</strong>:</p>
                <ul style="margin-right: 20px;">
                    <li>×›×œ ×˜×‘×œ×” ××ª××¨×ª ×™×©×•×ª ××—×ª ×‘×œ×‘×“, ×•××›×™×œ×” ×¨×§ ×©×“×•×ª ×”×©×™×™×›×™× ×œ×” ×‘××•×¤×Ÿ ×™×©×™×¨.</li>
                    <li>××™×Ÿ ×›×¤×™×œ×•×™×•×ª ××• × ×ª×•× ×™× ×—×•×–×¨×™× ×‘×™×Ÿ ×˜×‘×œ××•×ª (redundancy).</li>
                    <li>×›×œ ×©×“×” ×ª×œ×•×™ ×™×©×™×¨×•×ª ×‘××¤×ª×— ×”×¨××©×™ ×©×œ ×”×˜×‘×œ×”, ×•×œ× ×‘×©×“×•×ª ××—×¨×™×.</li>
                </ul>
                
                <p>×œ×“×•×’××”: ×‘×˜×‘×œ×ª <code>Deliveries</code>, ×”×©×“×•×ª <code>customer_id</code>, <code>restaurant_id</code> ×•Ö¾<code>delivery_person_id</code> ×”× ××¤×ª×—×•×ª ×–×¨×™× ×©××¤× ×™× ×œ×™×©×•×™×•×ª ××—×¨×•×ª, ×‘××§×•× ×œ×©×›×¤×œ ××ª ×›×œ ×¤×¨×˜×™ ×”×œ×§×•×—, ×”××¡×¢×“×” ××• ×”×©×œ×™×— ×‘×›×œ ×¨×©×•××”.</p>

                <div class="erd-container">
                    <h2 style="margin-top: 40px; margin-bottom: 10px;">×ª×¨×©×™× ERD ×”××¢×•×“×›×Ÿ</h2>
                    <img src="https://i.postimg.cc/XN2xfDhv/ERD4-Final-Databases-Project.png" alt="×ª×¨×©×™× ERD ××¢×•×“×›×Ÿ" style="max-width: 100%; height: auto; border: 1px solid #ccc; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
                </div>
            </div>

            <div class="subsection">
                <h3>×—×œ×§ ×’: ×™×¦×™×¨×ª ×”×“××˜××‘×™×™×¡ ×•×”×›× ×¡×ª × ×ª×•× ×™× (15 × ×§×•×“×•×ª)</h3>
                
                <div class="download-btn" onclick="downloadSQL1()">ğŸ“¥ ×”×•×¨×“ ×§×•×‘×¥ SQL ×œ××¢×¨×›×ª ××©×œ×•×—×™×</div>
                
                <div class="sql-container">
                    <div class="sql-code">DROP TABLE IF EXISTS Deliveries;
DROP TABLE IF EXISTS DeliveryPersons;
DROP TABLE IF EXISTS Restaurants;
DROP TABLE IF EXISTS Customers;

CREATE DATABASE IF NOT EXISTS FoodDelivery;
USE FoodDelivery;

CREATE TABLE Customers (
    customer_id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL,
    phone VARCHAR(20) NOT NULL
);

INSERT INTO Customers (name, phone) VALUES
('Noa', '0501234567'),
('Amit', '0529876543'),
('Rami', '0532223333'),
('Dana', '0544445555'),
('Yossi', '0556667777');

CREATE TABLE Restaurants (
    restaurant_id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL,
    city VARCHAR(50) NOT NULL
);

INSERT INTO Restaurants (name, city) VALUES
('Pizza Place', 'Tel Aviv'),
('Sushi Spot', 'Haifa'),
('Burger Hub', 'Jerusalem'),
('Falafel King', 'Eilat'),
('Vegan Vibes', 'Rishon LeZion');

CREATE TABLE DeliveryPersons (
    delivery_person_id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(50) NOT NULL,
    phone VARCHAR(20) NOT NULL
);

INSERT INTO DeliveryPersons (name, phone) VALUES
('Itay', '0581111111'),
('Maya', '0582222222'),
('David', '0583333333'),
('Or', '0584444444'),
('Lina', '0585555555');

CREATE TABLE Deliveries (
    delivery_id INT PRIMARY KEY AUTO_INCREMENT,
    customer_id INT NOT NULL,
    restaurant_id INT NOT NULL,
    delivery_person_id INT NOT NULL,
    amount DECIMAL(6,2),
    delivery_date DATE,
    FOREIGN KEY (customer_id) REFERENCES Customers(customer_id),
    FOREIGN KEY (restaurant_id) REFERENCES Restaurants(restaurant_id),
    FOREIGN KEY (delivery_person_id) REFERENCES DeliveryPersons(delivery_person_id)
);

INSERT INTO Deliveries (customer_id, restaurant_id, delivery_person_id, amount, delivery_date) VALUES
(1, 2, 3, 120.00, '2025-07-01'),
(2, 1, 1, 85.50, '2025-07-02'),
(3, 3, 2, 99.90, '2025-07-02'),
(4, 5, 4, 45.00, '2025-07-03'),
(5, 4, 5, 110.00, '2025-07-04');</div>
                </div>
            </div>
        </div>

        <!-- Question 2 -->
        <div class="question-section">
            <div class="question-title">
                <h2>×©××œ×” 2 - × ×™×ª×•×— ×“××˜××‘×™×™×¡ ×§×™×™×</h2>
                <p>×“××˜××‘×™×™×¡ Airbnb (60 × ×§×•×“×•×ª)</p>
            </div>

            <div class="subsection">
                <h3>×ª×™××•×¨ ×”×“××˜××‘×™×™×¡ (10 × ×§×•×“×•×ª)</h3>
                
                <div class="database-info">
                    <h4>×ª×™××•×¨ ××¡×“ ×”× ×ª×•× ×™× ×©× ×‘×—×¨</h4>
                    <p>××¡×“ ×”× ×ª×•× ×™× ××›×™×œ ××™×“×¢ ××¤×•×¨×˜ ×¢×œ ×¨×©×•××•×ª Airbnb ×‘××•×œ×‘× ×™, × ×™×• ×™×•×¨×§, ××¨×¦×•×ª ×”×‘×¨×™×ª. ×”×•× ×©×•××¨ × ×ª×•× ×™× ×‘××¡×¤×¨ ×˜×‘×œ××•×ª ××§×•×©×¨×•×ª, ×›×•×œ×œ Hosts, Listings, Neighbourhoods, ×•-ReviewStats. ×¤×¨×˜×™× ××¨×›×–×™×™× ×”×›×œ×•×œ×™× ×”× ××–×”×™ ×¨×©×•××•×ª, ×©××•×ª ×¨×©×•××•×ª, ××–×”×™ ×××¨×—×™× ×•×©××•×ª×™×”×, ×©×›×•× ×•×ª ×•×§×‘×•×¦×•×ª ×©×›×•× ×•×ª, ×¡×•×’×™ ×—×“×¨×™×, ××—×™×¨×™×, ××™× ×™××•× ×œ×™×œ×•×ª, ×–××™× ×•×ª, ×›××•×ª ×‘×™×§×•×¨×•×ª, ×ª××¨×™×›×™ ×‘×™×§×•×¨×ª ××—×¨×•× ×™×, ×•×ª×“×™×¨×•×ª ×‘×™×§×•×¨×•×ª.</p>
                    
                    <p><strong>××§×•×¨ ×”××™×“×¢:</strong><br>
                    <a href="https://data.insideairbnb.com/unitedstates/ny/albany/2025-06-09/visualisations/reviews.csv" target="_blank" style="color: #fff; text-decoration: underline;">https://data.insideairbnb.com/unitedstates/ny/albany/2025-06-09/visualisations/reviews.csv</a></p>
                </div>

                <div class="erd-container">
                    
                <h4><strong>×—×œ×§ ×‘:</strong></h4>
                <p>×”×“×™××’×¨××” ×”××•×¦×’×ª ××¦×™×’×” 4 ×™×©×•×™×•×ª ×©×•× ×•×ª: <code>Customers</code>, <code>Restaurants</code>, <code>DeliveryPersons</code>, ×•Ö¾<code>Deliveries</code>. ×˜×‘×œ×ª <code>Deliveries</code> ××§×•×©×¨×ª ×œ×›×œ ××—×ª ××”×™×©×•×™×•×ª ×”××—×¨×•×ª ×‘×××¦×¢×•×ª ××¤×ª×—×•×ª ×–×¨×™× (FK), ×›××©×¨ ×›×œ ×©×•×¨×” ×‘×˜×‘×œ×” ××™×™×¦×’×ª ××©×œ×•×— ×‘×•×“×“.</p>
                
                <p>×”×“××˜××‘×™×™×¡ ×¢×•× ×” ×¢×œ ×“×¨×™×©×•×ª <strong>× ×•×¨××œ×™×–×¦×™×”</strong> ×œ×¤×—×•×ª ×¢×“ <strong>×¦×•×¨×” ×©×œ×™×©×™×ª (3NF)</strong>:</p>
                <ul style="margin-right: 20px;">
                    <li>×›×œ ×˜×‘×œ×” ××ª××¨×ª ×™×©×•×ª ××—×ª ×‘×œ×‘×“, ×•××›×™×œ×” ×¨×§ ×©×“×•×ª ×”×©×™×™×›×™× ×œ×” ×‘××•×¤×Ÿ ×™×©×™×¨.</li>
                    <li>××™×Ÿ ×›×¤×™×œ×•×™×•×ª ××• × ×ª×•× ×™× ×—×•×–×¨×™× ×‘×™×Ÿ ×˜×‘×œ××•×ª (redundancy).</li>
                    <li>×›×œ ×©×“×” ×ª×œ×•×™ ×™×©×™×¨×•×ª ×‘××¤×ª×— ×”×¨××©×™ ×©×œ ×”×˜×‘×œ×”, ×•×œ× ×‘×©×“×•×ª ××—×¨×™×.</li>
                </ul>
                
                <p>×œ×“×•×’××”: ×‘×˜×‘×œ×ª <code>Deliveries</code>, ×”×©×“×•×ª <code>customer_id</code>, <code>restaurant_id</code> ×•Ö¾<code>delivery_person_id</code> ×”× ××¤×ª×—×•×ª ×–×¨×™× ×©××¤× ×™× ×œ×™×©×•×™×•×ª ××—×¨×•×ª, ×‘××§×•× ×œ×©×›×¤×œ ××ª ×›×œ ×¤×¨×˜×™ ×”×œ×§×•×—, ×”××¡×¢×“×” ××• ×”×©×œ×™×— ×‘×›×œ ×¨×©×•××”.</p>

                    <h2 style="margin-top: 40px; margin-bottom: 10px;">×ª×¨×©×™× ERD ×©×œ ××¡×“ ×”× ×ª×•× ×™×</h2>
                    <img src="https://i.postimg.cc/mgj1Fh81/Database-ERD2.png" alt="×ª×¨×©×™× ERD" style="max-width: 100%; height: auto; border: 1px solid #ccc; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.1);">
                </div>
            </div>
                </div>

                <div class="download-btn" onclick="downloadSQL2()">ğŸ“¥ ×”×•×¨×“ ×§×•×‘×¥ SQL ×œ××¢×¨×›×ª Airbnb</div>
                
                <div class="sql-container">
                    <div class="sql-code">CREATE DATABASE IF NOT EXISTS airbnb_project;
USE airbnb_project;

DROP TABLE IF EXISTS ReviewStats;
DROP TABLE IF EXISTS Listings;
DROP TABLE IF EXISTS Neighbourhoods;
DROP TABLE IF EXISTS Hosts;

CREATE TABLE Hosts (
  host_id INT PRIMARY KEY,
  host_name VARCHAR(255) NOT NULL,
  calculated_host_listings_count INT NOT NULL
);

CREATE TABLE Neighbourhoods (
  nbr_id INT AUTO_INCREMENT PRIMARY KEY,
  neighbourhood VARCHAR(255) NOT NULL,
  neighbourhood_group VARCHAR(255)
);

CREATE TABLE Listings (
  listing_id INT PRIMARY KEY,
  host_id INT NOT NULL,
  nbr_id  INT NOT NULL,
  name VARCHAR(255) NOT NULL,
  room_type VARCHAR(100) NOT NULL,
  price DECIMAL(10,2)   NOT NULL,
  minimum_nights INT    NOT NULL,
  availability_365 INT  NOT NULL,
  latitude  DECIMAL(9,5),
  longitude DECIMAL(9,5),
  license VARCHAR(100),
  FOREIGN KEY (host_id) REFERENCES Hosts(host_id)         ON DELETE CASCADE,
  FOREIGN KEY (nbr_id)  REFERENCES Neighbourhoods(nbr_id) ON DELETE RESTRICT
);

CREATE TABLE ReviewStats (
  listing_id INT PRIMARY KEY,
  number_of_reviews INT,
  last_review DATE,
  reviews_per_month DECIMAL(4,2),
  number_of_reviews_ltm INT,
  FOREIGN KEY (listing_id) REFERENCES Listings(listing_id) ON DELETE CASCADE
);

INSERT INTO Hosts (host_id, host_name, calculated_host_listings_count) VALUES
 (4621559,  'Kenneth',   1),
 (19648678, 'Terra',     4),
 (29288920, 'Gregg',     2),
 (17766924, 'Sugey',     1),
 (5691268,  'Elizabeth', 2);

INSERT INTO Neighbourhoods (neighbourhood, neighbourhood_group) VALUES
 ('THIRD WARD',   'THIRD WARD'),
 ('SIXTH WARD',   'SIXTH WARD'),
 ('SECOND WARD',  'SECOND WARD'),
 ('FOURTEENTH WARD','FOURTEENTH WARD'),
 ('FIFTEENTH WARD','FIFTEENTH WARD');

INSERT INTO Listings
(listing_id, host_id, nbr_id, name, room_type, price, minimum_nights,
 availability_365, latitude, longitude, license)
VALUES
 (2992450,  4621559, 1, 'Luxury 2 bedroom apartment', 'Entire home/apt',  70, 28,  70, 42.65789, -73.75370, NULL),
 (3820211, 19648678, 2, 'Restored Precinct in Center Sq. w/Parking', 'Entire home/apt', 100,  2, 335, 42.65222, -73.76724, NULL),
 (5651579, 29288920, 3, 'Large studio apt  by Capital Center & ESP@','Entire home/apt',  75,  2,  15, 42.64615, -73.75966, NULL),
 (6623339, 19648678, 2, 'Center Sq. Loft in Converted Precinct w/ Parking','Entire home/apt', 95, 2, 282, 42.65222, -73.76724, NULL),
 (9005989, 17766924, 2, 'Studio in The heart of Center SQ, in Albany NY','Entire home/apt', 86, 1, 128, 42.65559, -73.76506, NULL);

INSERT INTO ReviewStats
(listing_id, number_of_reviews, last_review, reviews_per_month, number_of_reviews_ltm)
VALUES
 (2992450,   9, '2022-08-17', 0.07,  0),
 (3820211, 308, '2025-03-29', 2.34,  6),
 (5651579, 371, '2025-02-16', 3.02, 24),
 (6623339, 331, '2025-02-09', 2.72, 14),
 (9005989, 620, '2025-05-08', 5.76, 29);</div>
                </div>
            </div>

            <div class="subsection">
                <h3>×©××œ×•×ª ××—×§×¨ ×•×©××™×œ×ª×•×ª (50 × ×§×•×“×•×ª)</h3>
                
                <table class="research-table">
                    <thead>
                        <tr>
                            <th>××” ×›×•×œ×œ×ª ×”×©××™×œ×ª×”</th>
                            <th>×©××œ×ª ×”××—×§×¨</th>
                            <th>××“×•×¢ ×”×™× ××¢× ×™×™× ×ª</th>
                            <th>×”×©××™×œ×ª×”</th>
                            <th>×ª×•×¦××•×ª×™×”</th>
                            <th>×ª×•×‘× ×•×ª ×•××¢× ×” ×¢×œ ×©××œ×ª ×”××—×§×¨</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="query-type">SELECT, WHERE</span></td>
                            <td><strong>××™×–×” ×¨×™×©×•××™× ×–××™× ×™× ×™×•×ª×¨ ×-300 ×™××™× ×‘×©× ×”?</strong></td>
                            <td>×—×©×•×‘ ×œ×–×”×•×ª ×¨×™×©×•××™× ×¢× ×–××™× ×•×ª ×’×‘×•×”×” ×©×™×›×•×œ×™× ×œ×”× ×™×‘ ×”×›× ×¡×•×ª ×§×‘×•×¢×•×ª ×œ×××¨×—×™×</td>
                            <td class="sql-code" style="direction: ltr; text-align: left; color: #333; background: #f8f9fa; padding: 10px; border-radius: 5px;">SELECT name, availability_365, price
FROM Listings 
WHERE availability_365 > 300;</td>
                            <td>× ××¦××• 2 ×¨×™×©×•××™×: "Restored Precinct in Center Sq. w/Parking" (335 ×™××™×, $100) ×•-"Center Sq. Loft in Converted Precinct w/ Parking" (282 ×™××™×, $95)</td>
                            <td>×”×××¨×—×ª Terra ×× ×”×œ×ª ××ª ×©× ×™ ×”×¨×™×©×•××™× ×”×–××™× ×™× ×‘×™×•×ª×¨, ××” ×©××¦×‘×™×¢ ×¢×œ × ×™×”×•×œ ××§×¦×•×¢×™ ×•×¤×•×˜× ×¦×™××œ ×”×›× ×¡×” ×’×‘×•×”</td>
                        </tr>
                        <tr>
                            <td><span class="query-type">Aggregation Method</span></td>
                            <td><strong>××” ×”××—×™×¨ ×”×××•×¦×¢ ×©×œ ×¨×™×©×•××™× ×‘××œ×‘× ×™?</strong></td>
                            <td>× ×ª×•×Ÿ ×‘×¡×™×¡×™ ×—×©×•×‘ ×œ×”×‘× ×ª ×©×•×§ ×”×©×›×™×¨×•×ª ×•×ª××—×•×¨ ×ª×—×¨×•×ª×™</td>
                            <td class="sql-code" style="direction: ltr; text-align: left; color: #333; background: #f8f9fa; padding: 10px; border-radius: 5px;">SELECT AVG(price) as average_price,
       MIN(price) as min_price,
       MAX(price) as max_price
FROM Listings;</td>
                            <td>××—×™×¨ ×××•×¦×¢: $85.20, ××—×™×¨ ××™× ×™××œ×™: $70, ××—×™×¨ ××§×¡×™××œ×™: $100</td>
                            <td>×”×©×•×§ ×‘××œ×‘× ×™ ×™×—×¡×™×ª ××—×™×“ ×¢× ×˜×•×•×— ××—×™×¨×™× ×¦×¨ ($30), ××” ×©××¢×™×“ ×¢×œ ×ª×—×¨×•×ª×™×•×ª ×’×‘×•×”×”</td>
                        </tr>
                        <tr>
                            <td><span class="query-type">GROUP BY</span></td>
                            <td><strong>×›××” ×¨×™×©×•××™× ×™×© ×œ×›×œ ×××¨×— ×•×××•×¦×¢ ×”×‘×™×§×•×¨×•×ª ×©×œ×”×?</strong></td>
                            <td>××–×”×” ×××¨×—×™× ×¤×¢×™×œ×™× ×•××§×¦×•×¢×™×™× ×¢×œ ×¤×™ ××¡×¤×¨ ×”×¨×™×©×•××™× ×•×¨××ª ×”×©×‘×™×¢×•×ª ×¨×¦×•×Ÿ</td>
                            <td class="sql-code" style="direction: ltr; text-align: left; color: #333; background: #f8f9fa; padding: 10px; border-radius: 5px;">SELECT h.host_name, 
       COUNT(l.listing_id) as listings_count,
       AVG(rs.number_of_reviews) as avg_reviews
FROM Hosts h
JOIN Listings l ON h.host_id = l.host_id
JOIN ReviewStats rs ON l.listing_id = rs.listing_id
GROUP BY h.host_id, h.host_name
ORDER BY listings_count DESC;</td>
                            <td>Terra: 2 ×¨×™×©×•××™×, ×××•×¦×¢ 319.5 ×‘×™×§×•×¨×•×ª<br>Gregg: 1 ×¨×™×©×•×, 371 ×‘×™×§×•×¨×•×ª<br>Kenneth: 1 ×¨×™×©×•×, 9 ×‘×™×§×•×¨×•×ª<br>Sugey: 1 ×¨×™×©×•×, 620 ×‘×™×§×•×¨×•×ª</td>
                            <td>Sugey ××•×‘×™×œ×” ×‘×‘×™×§×•×¨×•×ª (620) ×¢× ×¨×™×©×•× ×™×—×™×“, ×‘×¢×•×“ Terra ×× ×”×œ×ª ×‘×”×¦×œ×—×” ××¡×¤×¨ ×¨×™×©×•××™×. Kenneth ×—×“×© ×™×—×¡×™×ª ×‘×¤×œ×˜×¤×•×¨××”</td>
                        </tr>
                        <tr>
                            <td><span class="query-type">JOIN</span></td>
                            <td><strong>××” ×”×©×›×•× ×•×ª ×”×¤×•×¤×•×œ×¨×™×•×ª ×‘×™×•×ª×¨ ×œ×¤×™ ××¡×¤×¨ ×”×‘×™×§×•×¨×•×ª?</strong></td>
                            <td>××–×”×” ××–×•×¨×™× ××‘×•×§×©×™× ×©×™×›×•×œ×™× ×œ×”× ×—×•×ª ×”×—×œ×˜×•×ª ×”×©×§×¢×” ×•×ª××—×•×¨</td>
                            <td class="sql-code" style="direction: ltr; text-align: left; color: #333; background: #f8f9fa; padding: 10px; border-radius: 5px;">SELECT n.neighbourhood,
       COUNT(l.listing_id) as total_listings,
       SUM(rs.number_of_reviews) as total_reviews,
       AVG(l.price) as avg_price
FROM Neighbourhoods n
JOIN Listings l ON n.nbr_id = l.nbr_id
JOIN ReviewStats rs ON l.listing_id = rs.listing_id
GROUP BY n.nbr_id, n.neighbourhood
ORDER BY total_reviews DESC;</td>
                            <td>SIXTH WARD: 3 ×¨×™×©×•××™×, 1259 ×‘×™×§×•×¨×•×ª, ××—×™×¨ ×××•×¦×¢ $93.67<br>SECOND WARD: 1 ×¨×™×©×•×, 371 ×‘×™×§×•×¨×•×ª, ××—×™×¨ $75<br>THIRD WARD: 1 ×¨×™×©×•×, 9 ×‘×™×§×•×¨×•×ª, ××—×™×¨ $70</td>
                            <td>SIXTH WARD ×”×™× ×”×©×›×•× ×” ×”×¤×•×¤×•×œ×¨×™×ª ×‘×™×•×ª×¨ ×¢× ×”×›×™ ×”×¨×‘×” ×¤×¢×™×œ×•×ª ×•×‘×™×§×•×¨×•×ª, ×•×’× ××—×™×¨×™× ×’×‘×•×”×™× ×™×•×ª×¨ - ××” ×©××¢×™×“ ×¢×œ ××™×§×•× ××‘×•×§×©</td>
                        </tr>
                        <tr>
                            <td><span class="query-type">×©××œ×” ××¢× ×™×™× ×ª × ×•×¡×¤×ª</span></td>
                            <td><strong>×‘××™×–×” ×—×•×“×© × ×›×ª×‘×• ×”×›×™ ×”×¨×‘×” ×‘×™×§×•×¨×•×ª?</strong></td>
                            <td>××¦×™×’ ×ª× ×•×“×•×ª ×‘×©×•×§ ×œ××•×¨×š ×–××Ÿ, ×©×™×›×•×œ×•×ª ×œ×”×™×•×ª ××•×©×¤×¢×•×ª ×××™×¨×•×¢×™× ×’×“×•×œ×™× ××• ×××’××•×ª ×¢×•× ×ª×™×•×ª, ×•×¢×•×–×¨ ×œ×—×–×•×ª ×“×¤×•×¡×™ ×‘×™×§×•×© ×‘×¢×ª×™×“</td>
                            <td class="sql-code" style="direction: ltr; text-align: left; color: #333; background: #f8f9fa; padding: 10px; border-radius: 5px;">
                              SELECT DATE_FORMAT(last_review, '%Y-%m') AS review_month, SUM(number_of_reviews) AS total_reviews
                              FROM ReviewStats
                              GROUP BY review_month
                              ORDER BY total_reviews DESC
                              LIMIT 1;
                            </td>
                            <td>February 2025 â€” 702 reviews</td>
                            <td>×‘×¤×‘×¨×•××¨ 2025 × ×›×ª×‘×• ×”×›×™ ×”×¨×‘×” ×‘×™×§×•×¨×•×ª, ××” ×©××¨××” ×©×–×• ×”×™×™×ª×” ×”×ª×§×•×¤×” ×”×¤×¢×™×œ×” ×‘×™×•×ª×¨. ×–×” ×××¤×©×¨ ×œ×××¨×—×™× ×œ×”×ª×›×•× ×Ÿ ××¨××© ×•×œ×™×™×¢×œ ××ª ×”×”×™×¦×¢ ×‘×”×ª×× ×œ×ª×§×•×¤×” ×”×–×•.</td>
                          </tr>                          
                        </tbody>
                    </table>
                </div>
            </div>
    
            <script>
                function downloadSQL1() {
                    const sqlContent = `DROP TABLE IF EXISTS Deliveries;
                DROP TABLE IF EXISTS DeliveryPersons;
                DROP TABLE IF EXISTS Restaurants;
                DROP TABLE IF EXISTS Customers;
                
                CREATE DATABASE IF NOT EXISTS FoodDelivery;
                USE FoodDelivery;
                
                CREATE TABLE Customers (
                    customer_id INT PRIMARY KEY AUTO_INCREMENT,
                    name VARCHAR(50) NOT NULL,
                    phone VARCHAR(20) NOT NULL
                );
                
                INSERT INTO Customers (name, phone) VALUES
                ('Noa', '0501234567'),
                ('Amit', '0529876543'),
                ('Rami', '0532223333'),
                ('Dana', '0544445555'),
                ('Yossi', '0556667777');
                
                CREATE TABLE Restaurants (
                    restaurant_id INT PRIMARY KEY AUTO_INCREMENT,
                    name VARCHAR(50) NOT NULL,
                    city VARCHAR(50) NOT NULL
                );
                
                INSERT INTO Restaurants (name, city) VALUES
                ('Pizza Place', 'Tel Aviv'),
                ('Sushi Spot', 'Haifa'),
                ('Burger Hub', 'Jerusalem'),
                ('Falafel King', 'Eilat'),
                ('Vegan Vibes', 'Rishon LeZion');
                
                CREATE TABLE DeliveryPersons (
                    delivery_person_id INT PRIMARY KEY AUTO_INCREMENT,
                    name VARCHAR(50) NOT NULL,
                    phone VARCHAR(20) NOT NULL
                );
                
                INSERT INTO DeliveryPersons (name, phone) VALUES
                ('Itay', '0581111111'),
                ('Maya', '0582222222'),
                ('David', '0583333333'),
                ('Or', '0584444444'),
                ('Lina', '0585555555');
                
                CREATE TABLE Deliveries (
                    delivery_id INT PRIMARY KEY AUTO_INCREMENT,
                    customer_id INT NOT NULL,
                    restaurant_id INT NOT NULL,
                    delivery_person_id INT NOT NULL,
                    amount DECIMAL(6,2),
                    delivery_date DATE,
                    FOREIGN KEY (customer_id) REFERENCES Customers(customer_id),
                    FOREIGN KEY (restaurant_id) REFERENCES Restaurants(restaurant_id),
                    FOREIGN KEY (delivery_person_id) REFERENCES DeliveryPersons(delivery_person_id)
                );
                
                INSERT INTO Deliveries (customer_id, restaurant_id, delivery_person_id, amount, delivery_date) VALUES
                (1, 2, 3, 120.00, '2025-07-01'),
                (2, 1, 1, 85.50, '2025-07-02'),
                (3, 3, 2, 99.90, '2025-07-02'),
                (4, 5, 4, 45.00, '2025-07-03'),
                (5, 4, 5, 110.00, '2025-07-04');`;
                    
                    const blob = new Blob([sqlContent], { type: 'text/plain' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'DataBasesFinalSQL.sql';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }
                
                function downloadSQL2() {
                    const sqlContent = `CREATE DATABASE IF NOT EXISTS airbnb_project;
                USE airbnb_project;
                
                DROP TABLE IF EXISTS ReviewStats;
                DROP TABLE IF EXISTS Listings;
                DROP TABLE IF EXISTS Neighbourhoods;
                DROP TABLE IF EXISTS Hosts;
                
                CREATE TABLE Hosts (
                  host_id INT PRIMARY KEY,
                  host_name VARCHAR(255) NOT NULL,
                  calculated_host_listings_count INT NOT NULL
                );
                
                CREATE TABLE Neighbourhoods (
                  nbr_id INT AUTO_INCREMENT PRIMARY KEY,
                  neighbourhood VARCHAR(255) NOT NULL,
                  neighbourhood_group VARCHAR(255)
                );
                
                CREATE TABLE Listings (
                  listing_id INT PRIMARY KEY,
                  host_id INT NOT NULL,
                  nbr_id  INT NOT NULL,
                  name VARCHAR(255) NOT NULL,
                  room_type VARCHAR(100) NOT NULL,
                  price DECIMAL(10,2)   NOT NULL,
                  minimum_nights INT    NOT NULL,
                  availability_365 INT  NOT NULL,
                  latitude  DECIMAL(9,5),
                  longitude DECIMAL(9,5),
                  license VARCHAR(100),
                  FOREIGN KEY (host_id) REFERENCES Hosts(host_id)         ON DELETE CASCADE,
                  FOREIGN KEY (nbr_id)  REFERENCES Neighbourhoods(nbr_id) ON DELETE RESTRICT
                );
                
                CREATE TABLE ReviewStats (
                  listing_id INT PRIMARY KEY,
                  number_of_reviews INT,
                  last_review DATE,
                  reviews_per_month DECIMAL(4,2),
                  number_of_reviews_ltm INT,
                  FOREIGN KEY (listing_id) REFERENCES Listings(listing_id) ON DELETE CASCADE
                );
                
                INSERT INTO Hosts (host_id, host_name, calculated_host_listings_count) VALUES
                 (4621559,  'Kenneth',   1),
                 (19648678, 'Terra',     4),
                 (29288920, 'Gregg',     2),
                 (17766924, 'Sugey',     1),
                 (5691268,  'Elizabeth', 2);
                
                INSERT INTO Neighbourhoods (neighbourhood, neighbourhood_group) VALUES
                 ('THIRD WARD',   'THIRD WARD'),
                 ('SIXTH WARD',   'SIXTH WARD'),
                 ('SECOND WARD',  'SECOND WARD'),
                 ('FOURTEENTH WARD','FOURTEENTH WARD'),
                 ('FIFTEENTH WARD','FIFTEENTH WARD');
                
                INSERT INTO Listings
                (listing_id, host_id, nbr_id, name, room_type, price, minimum_nights,
                 availability_365, latitude, longitude, license)
                VALUES
                 (2992450,  4621559, 1, 'Luxury 2 bedroom apartment', 'Entire home/apt',  70, 28,  70, 42.65789, -73.75370, NULL),
                 (3820211, 19648678, 2, 'Restored Precinct in Center Sq. w/Parking', 'Entire home/apt', 100,  2, 335, 42.65222, -73.76724, NULL),
                 (5651579, 29288920, 3, 'Large studio apt  by Capital Center & ESP@','Entire home/apt',  75,  2,  15, 42.64615, -73.75966, NULL),
                 (6623339, 19648678, 2, 'Center Sq. Loft in Converted Precinct w/ Parking','Entire home/apt', 95, 2, 282, 42.65222, -73.76724, NULL),
                 (9005989, 17766924, 2, 'Studio in The heart of Center SQ, in Albany NY','Entire home/apt', 86, 1, 128, 42.65559, -73.76506, NULL);
                
                INSERT INTO ReviewStats
                (listing_id, number_of_reviews, last_review, reviews_per_month, number_of_reviews_ltm)
                VALUES
                 (2992450,   9, '2022-08-17', 0.07,  0),
                 (3820211, 308, '2025-03-29', 2.34,  6),
                 (5651579, 371, '2025-02-16', 3.02, 24),
                 (6623339, 331, '2025-02-09', 2.72, 14),
                 (9005989, 620, '2025-05-08', 5.76, 29);`;
                    
                    const blob = new Blob([sqlContent], { type: 'text/plain' });
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'DataBasesFinalSQL2.sql';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    URL.revokeObjectURL(url);
                }
                </script>
        </div>
    </body>
    </html>